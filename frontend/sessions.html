<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Buá»•i sinh hoáº¡t â€” CLB Tin Há»c</title>
  <link rel="stylesheet" href="css/common.css" />
  <link rel="stylesheet" href="css/sidebar.css" />
  <link rel="stylesheet" href="css/sessions.css" />
</head>
<body>

<div class="layout-wrapper">
  <main class="main-content">
    <div class="page-container">

      <!-- Page Header -->
      <div class="page-header">
        <div>
          <div class="page-title">ğŸ“… Buá»•i sinh hoáº¡t</div>
          <div class="page-subtitle">Quáº£n lÃ½ cÃ¡c buá»•i sinh hoáº¡t cá»§a cÃ¢u láº¡c bá»™</div>
        </div>
        <div class="header-actions">
          <div class="search-box">
            <span class="search-icon">ğŸ”</span>
            <input type="text" id="searchInput" class="search-input" placeholder="TÃ¬m kiáº¿m buá»•i sinh hoáº¡t..." />
          </div>
          <button id="btnAddSession" class="btn admin-only" onclick="openAddModal()">
            ï¼‹ ThÃªm buá»•i
          </button>
        </div>
      </div>

      <!-- Stats row -->
      <div class="session-stats" id="sessionStats">
        <div class="stat-chip skeleton" style="height:52px;"></div>
        <div class="stat-chip skeleton" style="height:52px;"></div>
        <div class="stat-chip skeleton" style="height:52px;"></div>
        <div class="stat-chip skeleton" style="height:52px;"></div>
      </div>

      <!-- Tab filter -->
      <div class="tab-filter">
        <button class="tab-btn active" data-type="all">ğŸ—‚ï¸ Táº¥t cáº£</button>
        <button class="tab-btn" data-type="regular">ğŸ“Œ Sinh hoáº¡t cá»‘ Ä‘á»‹nh</button>
        <button class="tab-btn" data-type="other">ğŸ¯ Hoáº¡t Ä‘á»™ng khÃ¡c</button>
      </div>

      <!-- Session cards grid -->
      <div class="sessions-grid" id="sessionsGrid">
        <div class="session-card skeleton" style="height:170px;"></div>
        <div class="session-card skeleton" style="height:170px;"></div>
        <div class="session-card skeleton" style="height:170px;"></div>
        <div class="session-card skeleton" style="height:170px;"></div>
        <div class="session-card skeleton" style="height:170px;"></div>
        <div class="session-card skeleton" style="height:170px;"></div>
      </div>

      <!-- Empty state -->
      <div class="empty-state" id="emptyState" style="display:none;">
        <span class="empty-state-icon">ğŸ“…</span>
        <p>ChÆ°a cÃ³ buá»•i sinh hoáº¡t nÃ o. <span class="admin-only">HÃ£y thÃªm buá»•i Ä‘áº§u tiÃªn!</span></p>
      </div>

    </div>
  </main>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MODAL: ThÃªm / Sá»­a buá»•i sinh hoáº¡t
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="sessionModal">
  <div class="modal modal-lg">
    <div class="modal-header">
      <h3 id="sessionModalTitle">ThÃªm buá»•i sinh hoáº¡t</h3>
      <button class="modal-close" onclick="closeModal('sessionModal')">&times;</button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="sessionId" />

      <!-- Loáº¡i buá»•i -->
      <div class="form-group">
        <label>Loáº¡i buá»•i sinh hoáº¡t <span class="required">*</span></label>
        <div class="type-radio-group">
          <label class="type-radio-option" id="typeOptRegular">
            <input type="radio" name="sessionType" id="sessionType" value="regular" checked />
            <span class="type-radio-icon">ğŸ“Œ</span>
            <div>
              <div class="type-radio-title">Sinh hoáº¡t cá»‘ Ä‘á»‹nh</div>
              <div class="type-radio-desc">Buá»•i há»c thÆ°á»ng ká»³ hÃ ng tuáº§n (VD: Nháº­p mÃ´n láº­p trÃ¬nh, Láº­p trÃ¬nh web...)</div>
            </div>
          </label>
          <label class="type-radio-option" id="typeOptOther">
            <input type="radio" name="sessionType" value="other" />
            <span class="type-radio-icon">ğŸ¯</span>
            <div>
              <div class="type-radio-title">Hoáº¡t Ä‘á»™ng khÃ¡c</div>
              <div class="type-radio-desc">Sá»± kiá»‡n, workshop, hoáº¡t Ä‘á»™ng ngoáº¡i khoÃ¡ ngoÃ i lá»‹ch thÆ°á»ng ká»³</div>
            </div>
          </label>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="sessionName">TÃªn buá»•i sinh hoáº¡t <span class="required">*</span></label>
          <input type="text" id="sessionName" class="form-control" placeholder="VD: Nháº­p mÃ´n láº­p trÃ¬nh - Tuáº§n 5" />
        </div>
        <div class="form-group">
          <label for="sessionDate">NgÃ y tá»• chá»©c</label>
          <input type="datetime-local" id="sessionDate" class="form-control" />
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label for="sessionLocation">Äá»‹a Ä‘iá»ƒm</label>
          <input type="text" id="sessionLocation" class="form-control" placeholder="VD: PhÃ²ng B101" />
        </div>
        <div class="form-group">
          <label for="sessionMaxParticipants">Sá»‘ lÆ°á»£ng tá»‘i Ä‘a</label>
          <input type="number" id="sessionMaxParticipants" class="form-control" placeholder="50" min="1" />
        </div>
      </div>

      <!-- Instructors -->
      <div class="form-group">
        <label>NgÆ°á»i phá»¥ trÃ¡ch</label>
        <div id="instructorsList" class="instructors-list"></div>
        <button type="button" class="btn btn-secondary btn-sm" onclick="addInstructorRow()" style="margin-top:.5rem;">
          ï¼‹ ThÃªm ngÆ°á»i phá»¥ trÃ¡ch
        </button>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeModal('sessionModal')">Há»§y</button>
      <button class="btn" id="btnSaveSession" onclick="saveSession()">ğŸ’¾ LÆ°u</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MODAL: Chi tiáº¿t buá»•i sinh hoáº¡t + Äiá»ƒm danh
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="detailModal">
  <div class="modal modal-xl">
    <div class="modal-header">
      <h3 id="detailModalTitle">Chi tiáº¿t buá»•i sinh hoáº¡t</h3>
      <button class="modal-close" onclick="closeModal('detailModal')">&times;</button>
    </div>
    <div class="modal-body">
      <!-- Session info -->
      <div class="session-detail-info" id="sessionDetailInfo"></div>

      <!-- Divider -->
      <div class="section-divider">
        <span>âœ… Danh sÃ¡ch Ä‘iá»ƒm danh</span>
      </div>

      <!-- Attendance toolbar -->
      <div class="attendance-toolbar">
        <div class="attendance-stats" id="attendanceStats">
          <span class="att-badge att-joined">Tham gia: <strong id="attCountJoined">0</strong></span>
          <span class="att-badge att-present">CÃ³ máº·t: <strong id="attCountPresent">0</strong></span>
          <span class="att-badge att-absent">Váº¯ng: <strong id="attCountAbsent">0</strong></span>
          <span class="att-badge att-excused">CÃ³ phÃ©p: <strong id="attCountExcused">0</strong></span>
          <span class="att-badge att-total">Tá»•ng: <strong id="attCountTotal">0</strong></span>
        </div>
        <div class="attendance-actions admin-only">
          <button class="btn btn-sm btn-success" onclick="markAllPresent()">âœ… Äiá»ƒm danh táº¥t cáº£</button>
          <button class="btn btn-sm btn-secondary" onclick="saveAllAttendance()">ğŸ’¾ LÆ°u Ä‘iá»ƒm danh</button>
        </div>
      </div>

      <!-- Attendance table -->
      <div class="table-wrapper">
        <table class="table" id="attendanceTable">
          <thead>
            <tr>
              <th>#</th>
              <th>MSSV</th>
              <th>Há» tÃªn</th>
              <th class="th-participate">
                <span>Tham gia</span>
                <label class="check-all-wrap admin-only" title="Chá»n / bá» chá»n táº¥t cáº£">
                  <input type="checkbox" id="checkAllParticipate" onchange="toggleAllParticipate(this.checked)" />
                </label>
              </th>
              <th>Tráº¡ng thÃ¡i</th>
              <th>Ghi chÃº</th>
            </tr>
          </thead>
          <tbody id="attendanceBody">
            <tr><td colspan="6" style="text-align:center;color:#bbb;padding:2rem;">Äang táº£i...</td></tr>
          </tbody>
        </table>
      </div>

      <!-- Biá»ƒu Ä‘á»“ thá»‘ng kÃª -->
      <div class="section-divider" style="margin-top:1.5rem;">
        <span>ğŸ“Š Thá»‘ng kÃª Ä‘iá»ƒm danh</span>
      </div>
      <div class="attendance-chart-area" id="attendanceChartArea"></div>

    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeModal('detailModal')">ÄÃ³ng</button>
      <button class="btn admin-only" onclick="saveAllAttendance()">ğŸ’¾ LÆ°u Ä‘iá»ƒm danh</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MODAL: XÃ¡c nháº­n xÃ³a
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="deleteModal">
  <div class="modal" style="max-width:420px;">
    <div class="modal-header">
      <h3>XÃ¡c nháº­n xÃ³a</h3>
      <button class="modal-close" onclick="closeModal('deleteModal')">&times;</button>
    </div>
    <div class="modal-body">
      <div class="delete-warning">
        <div class="delete-icon">ğŸ—‘ï¸</div>
        <p>Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a buá»•i sinh hoáº¡t <strong id="deleteSessionName"></strong>?</p>
        <p class="delete-note">Thao tÃ¡c nÃ y sáº½ xÃ³a toÃ n bá»™ dá»¯ liá»‡u Ä‘iá»ƒm danh liÃªn quan vÃ  <strong>khÃ´ng thá»ƒ hoÃ n tÃ¡c</strong>.</p>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="closeModal('deleteModal')">Há»§y</button>
      <button class="btn btn-danger" onclick="confirmDelete()">XÃ³a</button>
    </div>
  </div>
</div>

<script src="js/api.js"></script>
<script src="js/utils.js"></script>
<script src="js/sidebar.js"></script>
<script src="js/sessions.js"></script>

<script>
// Sync radio button visual state
document.querySelectorAll('input[name="sessionType"]').forEach(radio => {
    radio.addEventListener('change', () => {
        document.querySelectorAll('.type-radio-option').forEach(opt => opt.classList.remove('selected'));
        radio.closest('.type-radio-option').classList.add('selected');
    });
});
// Init state
document.querySelector('input[name="sessionType"]:checked')
    ?.closest('.type-radio-option')?.classList.add('selected');
</script>
</body>
</html>